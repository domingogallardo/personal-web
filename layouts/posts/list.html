{{ define "main" }}
<h1>{{ .Title }}</h1>
{{ $pages := .Pages.ByDate.Reverse }}
{{ $groups := $pages.GroupByDate "2006" "desc" }}
{{ range $group := $groups }}
  <section class="posts-year-group">
    <h2 class="posts-year-heading">{{ $group.Key }}</h2>
    <ul class="list posts-year-list">
      {{ range $group.Pages }}
        <li>
          <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          <span class="meta">Â· {{ .Date.Format "2006-01-02" }}</span>
          {{ with .Params.tags }}
            <span class="post-tags">
              {{ range $tag := . }}
                {{ $tagPage := $.Site.GetPage (printf "/tags/%s" ($tag | urlize)) }}
                <a class="post-tag" href="{{ if $tagPage }}{{ $tagPage.RelPermalink }}{{ else }}{{ "/tags/" | relURL }}{{ $tag | urlize }}/{{ end }}">#{{ $tag }}</a>
              {{ end }}
            </span>
          {{ end }}
        </li>
      {{ end }}
    </ul>
  </section>
  {{ end }}
{{ end }}
